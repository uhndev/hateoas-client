<div class="clearfix">
  <form ng-hide="advanceSearch">
    <div class="form-group no-margin has-feedback has-feedback-left">
      <i class="no-top form-control-feedback fa fa-search"></i>
      <label class="control-label ng-hide" translate>
        COMMON.HATEOAS.QUERY.PLACEHOLDER
      </label>
      <input type="text"
             class="form-control"
             context-translator="COMMON.HATEOAS.QUERY.PLACEHOLDER"
             placeholder="{{ 'COMMON.HATEOAS.QUERY.PLACEHOLDER' | translate }}"
             ng-model-options="{ debounce: 700 }"
             ng-model="value"
             ng-change="search(value)"/>
    </div>
  </form>
  <div uib-collapse="!advanceSearch">
    <ul ng-repeat="(property, expression) in query track by $index">
      <li ng-if="expression|isString">
        {{ property }}
        <i class="condition"> is </i>
        <b> {{ expression | json }} </b>
      </li>
      <li ng-if="expression|isNumber">
        {{ property }}
        <i class="condition"> equals </i>
        <b> {{ expression | json }} </b>
      </li>
      <li ng-if="expression|isObject" ng-repeat="(cond, val) in expression track by $index">
        {{ property }}
        <i> {{ cond }} </i>
        <b ng-if="val|isArray"> {{ val.join(' or ') }} </b>
        <b ng-if="!(val|isArray)"> {{ val }} </b>
      </li>
    </ul>
    <form class="form-inline" role="form">
      <div class="form-group">
        <select ng-model="field" class="form-control"
                ng-options="field as field.prompt | translate for field in fields">
        </select>
      </div>
      <div class="form-group">
        <select ng-disabled="!!!field.type" class="form-control" ng-model="comparator">
          <option value="{{criterion.val}}" ng-repeat="criterion in operators track by $index" translate>
            {{criterion.translationKey}}
          </option>
        </select>
      </div>
      <div class="form-group">
        <input ng-disabled="!!!field || !!!comparator"
               class="form-control"
               type="text"
               ng-model="value"/>
      </div>
      <button ng-disabled="!!!field || !!!comparator || !!!value"
              class="btn btn-default"
              ng-click="add(field.name, comparator, value)" translate
              context-translator="{{COMMON.HATEOAS.QUERY.ADD_BTN}}">
        COMMON.HATEOAS.QUERY.ADD_BTN
      </button>
      <button ng-disabled="!!!query"
              class="btn btn-warning"
              ng-click="reset()" translate
              context-translator="{{COMMON.HATEOAS.QUERY.RESET_BTN}}">
        COMMON.HATEOAS.QUERY.RESET_BTN
      </button>
    </form>
  </div>
  <div class="btn-group pull-left">
    <label class="btn btn-default btn-link btn-xs" ng-repeat="queryLink in hateoasQueries">
      <span ng-if="!queryLink.populate" translate={{queryLink.prompt}}></span>
      <span ng-if="!queryLink.populate">
        <input type="radio" name="queryLink.rel" ng-click="applyQuery(queryLink.where)"
               value="queryLink.where"/>
      </span>
      <span ng-if="queryLink.populate" translate={{queryLink.prompt}}></span>
      <span ng-if="queryLink.populate">
        <input type="radio" name="queryLink.rel" ng-click="applyPopulate(queryLink.populate)"
               value="queryLink.populate"/>
        </span>

    </label>
  </div>
  <button type="button"
          ng-hide="advanced"
          class="btn btn-link btn-sm pull-right no-margin no-padding"
          ng-model="advanceSearch"
          uib-btn-checkbox
          uib-btn-checkbox-true="1"
          uib-btn-checkbox-false="0"
          context-translator="COMMON.HATEOAS.QUERY.ADVANCED.SEARCH_BTN">
    <span translate>COMMON.HATEOAS.QUERY.ADVANCED.SEARCH_BTN</span>
  </button>
</div>
